{"id":"anofox-statistics-1g4","title":"Add options MAP to alm_fit_predict_by","description":"Add optional options MAP for distribution, intercept, max_iterations, tolerance, confidence_level, null_policy","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-09T08:31:54.602514427+01:00","created_by":"simonm","updated_at":"2026-01-09T08:31:54.602514427+01:00","dependencies":[{"issue_id":"anofox-statistics-1g4","depends_on_id":"anofox-statistics-z99","type":"blocks","created_at":"2026-01-09T08:32:11.50973456+01:00","created_by":"simonm"}]}
{"id":"anofox-statistics-4s4","title":"Add tests for *_fit_predict_by with options","description":"Write tests verifying options are correctly passed through to underlying *_fit_predict_agg functions","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-09T08:31:57.31411483+01:00","created_by":"simonm","updated_at":"2026-01-09T08:31:57.31411483+01:00","dependencies":[{"issue_id":"anofox-statistics-4s4","depends_on_id":"anofox-statistics-z8v","type":"blocks","created_at":"2026-01-09T08:32:13.350291384+01:00","created_by":"simonm"},{"issue_id":"anofox-statistics-4s4","depends_on_id":"anofox-statistics-6zm","type":"blocks","created_at":"2026-01-09T08:32:13.378534328+01:00","created_by":"simonm"},{"issue_id":"anofox-statistics-4s4","depends_on_id":"anofox-statistics-8x7","type":"blocks","created_at":"2026-01-09T08:32:13.412331454+01:00","created_by":"simonm"},{"issue_id":"anofox-statistics-4s4","depends_on_id":"anofox-statistics-pb9","type":"blocks","created_at":"2026-01-09T08:32:13.441065678+01:00","created_by":"simonm"},{"issue_id":"anofox-statistics-4s4","depends_on_id":"anofox-statistics-ooj","type":"blocks","created_at":"2026-01-09T08:32:13.472045847+01:00","created_by":"simonm"},{"issue_id":"anofox-statistics-4s4","depends_on_id":"anofox-statistics-meg","type":"blocks","created_at":"2026-01-09T08:32:13.501113204+01:00","created_by":"simonm"},{"issue_id":"anofox-statistics-4s4","depends_on_id":"anofox-statistics-1g4","type":"blocks","created_at":"2026-01-09T08:32:13.527105198+01:00","created_by":"simonm"},{"issue_id":"anofox-statistics-4s4","depends_on_id":"anofox-statistics-tia","type":"blocks","created_at":"2026-01-09T08:32:13.556046924+01:00","created_by":"simonm"}]}
{"id":"anofox-statistics-6zm","title":"Add options MAP to ridge_fit_predict_by","description":"Add optional options MAP parameter for alpha, fit_intercept, confidence_level, null_policy","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-09T08:31:48.344523812+01:00","created_by":"simonm","updated_at":"2026-01-09T08:31:48.344523812+01:00","dependencies":[{"issue_id":"anofox-statistics-6zm","depends_on_id":"anofox-statistics-z99","type":"blocks","created_at":"2026-01-09T08:32:11.365693111+01:00","created_by":"simonm"}]}
{"id":"anofox-statistics-8x7","title":"Add options MAP to elasticnet_fit_predict_by","description":"Add optional options MAP for alpha, l1_ratio, max_iterations, tolerance, fit_intercept, confidence_level, null_policy","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-09T08:31:49.564608871+01:00","created_by":"simonm","updated_at":"2026-01-09T08:31:49.564608871+01:00","dependencies":[{"issue_id":"anofox-statistics-8x7","depends_on_id":"anofox-statistics-z99","type":"blocks","created_at":"2026-01-09T08:32:11.392489162+01:00","created_by":"simonm"}]}
{"id":"anofox-statistics-bdl","title":"Update API_REFERENCE.md documentation","description":"Update Fit-Predict Table Macros section to document new options parameter for each macro","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-09T08:31:58.475233746+01:00","created_by":"simonm","updated_at":"2026-01-09T08:31:58.475233746+01:00","dependencies":[{"issue_id":"anofox-statistics-bdl","depends_on_id":"anofox-statistics-4s4","type":"blocks","created_at":"2026-01-09T08:32:14.469279349+01:00","created_by":"simonm"}]}
{"id":"anofox-statistics-kkk","title":"Implement *_fit_predict_by table macros for regression functions","description":"## Overview\n\nImplement table macros for regression fit-predict functions following the pattern established by `ts_forecast_by` in anofox-forecast extension. These macros will provide a user-friendly SQL interface for running regression predictions on grouped data.\n\n## Background\n\nThe anofox-forecast extension provides `ts_forecast_by` as a table macro that:\n- Wraps the lower-level `_ts_forecast()` scalar function\n- Provides column-by-name interface (unquoted identifiers)\n- Handles grouping/ungrouping automatically\n- Unnests results into long format (one row per prediction)\n- Uses `query_table(source::VARCHAR)` for dynamic table references\n\n## Proposed Functions\n\nCreate table macros for each `*_fit_predict_agg` function:\n\n| Table Macro | Wraps |\n|-------------|-------|\n| `ols_fit_predict_by` | `ols_fit_predict_agg` |\n| `ridge_fit_predict_by` | `ridge_fit_predict_agg` |\n| `elasticnet_fit_predict_by` | `elasticnet_fit_predict_agg` |\n| `wls_fit_predict_by` | `wls_fit_predict_agg` |\n| `rls_fit_predict_by` | `rls_fit_predict_agg` |\n| `bls_fit_predict_by` | `bls_fit_predict_agg` |\n| `alm_fit_predict_by` | `alm_fit_predict_agg` |\n| `poisson_fit_predict_by` | `poisson_fit_predict_agg` |\n\n## Proposed Signature\n\n```sql\nols_fit_predict_by(\n    source,      -- VARCHAR: table name\n    group_col,   -- IDENTIFIER: grouping column\n    y_col,       -- IDENTIFIER: target variable\n    x_cols,      -- LIST or IDENTIFIER[]: feature columns\n    options      -- MAP: optional parameters\n) -\u003e TABLE\n```\n\n## Expected Output Format (Long Format)\n\n| Column | Type | Description |\n|--------|------|-------------|\n| group_id | ANY | Group identifier |\n| row_idx | INTEGER | Original row index |\n| y | DOUBLE | Original y value (NULL for OOS) |\n| x | LIST(DOUBLE) | Feature values |\n| yhat | DOUBLE | Predicted value |\n| yhat_lower | DOUBLE | Lower prediction interval |\n| yhat_upper | DOUBLE | Upper prediction interval |\n| is_training | BOOLEAN | Training vs OOS indicator |\n\n## Implementation Pattern\n\nFollow the pattern from `ts_forecast_by` in anofox-forecast:\n\n1. **SQL Macro Definition** in `src/macros/`:\n   ```sql\n   WITH predictions AS (\n       SELECT\n           group_col AS group_id,\n           *_fit_predict_agg(y_col, [x_cols...], options) AS pred\n       FROM query_table(source::VARCHAR)\n       GROUP BY group_col\n   )\n   SELECT\n       group_id,\n       UNNEST(pred) AS prediction\n   FROM predictions\n   ```\n\n2. **C++ Registration** following `TsTableMacro` struct pattern\n\n3. **Test Coverage** for each macro\n\n## Reference Implementation\n\nSee anofox-forecast:\n- `src/macros/ts_macros.cpp` (lines 466-555)\n- `test/sql/ts_forecast_by.test`\n\n## Acceptance Criteria\n\n- [ ] All 8 table macros implemented\n- [ ] Column-by-name interface (unquoted identifiers)\n- [ ] Long format output with unnested predictions\n- [ ] Options MAP passed through to underlying aggregate\n- [ ] Comprehensive test coverage\n- [ ] Documentation in API_REFERENCE.md","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-08T19:12:11.516701682+01:00","created_by":"simonm","updated_at":"2026-01-08T20:24:12.135058287+01:00","closed_at":"2026-01-08T20:24:12.135058287+01:00","close_reason":"Implemented 8 *_fit_predict_by table macros with tests"}
{"id":"anofox-statistics-meg","title":"Add options MAP to bls_fit_predict_by","description":"Add optional options MAP for lower_bound, upper_bound, intercept, max_iterations, tolerance, confidence_level, null_policy","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-09T08:31:53.330671303+01:00","created_by":"simonm","updated_at":"2026-01-09T08:31:53.330671303+01:00","dependencies":[{"issue_id":"anofox-statistics-meg","depends_on_id":"anofox-statistics-z99","type":"blocks","created_at":"2026-01-09T08:32:11.481414876+01:00","created_by":"simonm"}]}
{"id":"anofox-statistics-og8","title":"Add options parameter to *_fit_predict_by table macros","status":"open","priority":2,"issue_type":"feature","created_at":"2026-01-09T08:31:31.427664474+01:00","created_by":"simonm","updated_at":"2026-01-09T08:31:31.427664474+01:00"}
{"id":"anofox-statistics-ooj","title":"Add options MAP to rls_fit_predict_by","description":"Add optional options MAP for forgetting_factor, initial_p_diagonal, fit_intercept, confidence_level, null_policy","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-09T08:31:52.021302044+01:00","created_by":"simonm","updated_at":"2026-01-09T08:31:52.021302044+01:00","dependencies":[{"issue_id":"anofox-statistics-ooj","depends_on_id":"anofox-statistics-z99","type":"blocks","created_at":"2026-01-09T08:32:11.453702418+01:00","created_by":"simonm"}]}
{"id":"anofox-statistics-pb9","title":"Add options MAP to wls_fit_predict_by","description":"Add optional options MAP for fit_intercept, confidence_level, null_policy","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-09T08:31:50.435890473+01:00","created_by":"simonm","updated_at":"2026-01-09T08:31:50.435890473+01:00","dependencies":[{"issue_id":"anofox-statistics-pb9","depends_on_id":"anofox-statistics-z99","type":"blocks","created_at":"2026-01-09T08:32:11.42339594+01:00","created_by":"simonm"}]}
{"id":"anofox-statistics-tia","title":"Add options MAP to poisson_fit_predict_by","description":"Add optional options MAP for link, intercept, max_iterations, tolerance, confidence_level, null_policy","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-09T08:31:55.771304582+01:00","created_by":"simonm","updated_at":"2026-01-09T08:31:55.771304582+01:00","dependencies":[{"issue_id":"anofox-statistics-tia","depends_on_id":"anofox-statistics-z99","type":"blocks","created_at":"2026-01-09T08:32:11.543057541+01:00","created_by":"simonm"}]}
{"id":"anofox-statistics-z8v","title":"Add options MAP to ols_fit_predict_by","description":"Add optional options MAP parameter for fit_intercept, confidence_level, null_policy","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-09T08:31:47.46271717+01:00","created_by":"simonm","updated_at":"2026-01-09T08:31:47.46271717+01:00","dependencies":[{"issue_id":"anofox-statistics-z8v","depends_on_id":"anofox-statistics-z99","type":"blocks","created_at":"2026-01-09T08:32:11.336793869+01:00","created_by":"simonm"}]}
{"id":"anofox-statistics-z99","title":"Locate table macro definitions in codebase","description":"Find where *_fit_predict_by macros are defined to understand current implementation","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-09T08:31:46.573925933+01:00","created_by":"simonm","updated_at":"2026-01-09T08:31:46.573925933+01:00"}
