# name: test/sql/fit_predict/test_rls_fit_predict_rolling.test
# description: Test RLS fit-predict with rolling windows
# group: [fit_predict]

require anofox_statistics

statement ok
CREATE TABLE rls_rolling AS
SELECT i as time_id, i::DOUBLE as x, (i * 2.0)::DOUBLE as y
FROM range(1, 16) t(i);

query I
SELECT COUNT(*) as predictions
FROM (SELECT time_id, anofox_stats_rls_fit_predict(y, [x], {'forgetting_factor': 0.99}) OVER (ORDER BY time_id) as pred FROM rls_rolling)
WHERE (pred).yhat IS NOT NULL;
----
13

statement ok
DROP TABLE rls_rolling;
