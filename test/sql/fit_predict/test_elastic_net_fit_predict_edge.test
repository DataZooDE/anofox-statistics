# name: test/sql/fit_predict/test_elastic_net_fit_predict_edge.test
# description: Test ElasticNet fit-predict edge cases
# group: [fit_predict]

require anofox_statistics

statement ok
CREATE TABLE elasticnet_edge AS
SELECT
    CASE WHEN i <= 6 THEN (i * 2.0 + 1.0)::DOUBLE ELSE NULL END as y,
    i::DOUBLE as x1,
    i as id
FROM range(1, 11) t(i);

# Test basic functionality works
query I
SELECT COUNT(*) as valid_predictions
FROM (SELECT id, anofox_stats_elasticnet_fit_predict(y, [x1], {'alpha': 1.0, 'l1_ratio': 0.5}) OVER (ORDER BY id) as pred FROM elasticnet_edge)
WHERE (pred).yhat IS NOT NULL;
----
8

statement ok
DROP TABLE elasticnet_edge;
