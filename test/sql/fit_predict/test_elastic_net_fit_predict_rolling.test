# name: test/sql/fit_predict/test_elastic_net_fit_predict_rolling.test
# description: Test ElasticNet fit-predict with rolling windows
# group: [fit_predict]

require anofox_statistics

statement ok
CREATE TABLE elasticnet_rolling AS
SELECT i as time_id, i::DOUBLE as x, (i * 2.0)::DOUBLE as y
FROM range(1, 16) t(i);

query I
SELECT COUNT(*) as predictions
FROM (SELECT time_id, anofox_stats_elasticnet_fit_predict(y, [x], {'alpha': 0.1, 'l1_ratio': 0.5}) OVER (ORDER BY time_id) as pred FROM elasticnet_rolling)
WHERE (pred).yhat IS NOT NULL;
----
13

statement ok
DROP TABLE elasticnet_rolling;
