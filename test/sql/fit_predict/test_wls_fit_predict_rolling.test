# name: test/sql/fit_predict/test_wls_fit_predict_rolling.test
# description: Test WLS fit-predict with rolling windows
# group: [fit_predict]

require anofox_statistics

statement ok
CREATE TABLE wls_rolling AS
SELECT i as time_id, i::DOUBLE as x, (i * 2.0)::DOUBLE as y, 1.0::DOUBLE as w
FROM range(1, 16) t(i);

query I
SELECT COUNT(*) as predictions
FROM (SELECT time_id, anofox_stats_wls_fit_predict(y, [x], w) OVER (ORDER BY time_id) as pred FROM wls_rolling)
WHERE (pred).yhat IS NOT NULL;
----
13

statement ok
DROP TABLE wls_rolling;
